

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; Model Context Protocol (MCP) Python SDK  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=d8a309f0" />

  
    <link rel="canonical" href="/mcp_docs/api-reference.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=7f41d439"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced MCP Topics" href="advanced-topics.html" />
    <link rel="prev" title="MCP Examples" href="examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Model Context Protocol (MCP) Python SDK
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to Model Context Protocol (MCP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started with MCP Python SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="server-guide.html">Building MCP Servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="client-guide.html">Building MCP Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">MCP Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#server-api">Server API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastmcp">FastMCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="#image">Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="#complex-types-with-pydantic">Complex Types with Pydantic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-with-lifespan">Server with Lifespan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server">Server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#client-api">Client API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#clientsession">ClientSession</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connection-functions">Connection Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#type-definitions">Type Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prompt-utilities">Prompt Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-interface">Command Line Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#development-mode-options">Development Mode Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-options">Installation Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced-topics.html">Advanced MCP Topics</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Model Context Protocol (MCP) Python SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<p>This page provides a reference for the main classes and functions in the MCP Python SDK.</p>
<section id="server-api">
<h2>Server API<a class="headerlink" href="#server-api" title="Link to this heading"></a></h2>
<section id="fastmcp">
<h3>FastMCP<a class="headerlink" href="#fastmcp" title="Link to this heading"></a></h3>
<p>The high-level server API for quickly creating MCP servers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.fastmcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastMCP</span>

<span class="c1"># Create a server</span>
<span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;MyServer&quot;</span><span class="p">,</span>             <span class="c1"># Server name</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;My MCP server&quot;</span><span class="p">,</span> <span class="c1"># Optional description</span>
    <span class="n">dependencies</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pandas&quot;</span><span class="p">],</span>     <span class="c1"># Optional dependencies</span>
    <span class="n">lifespan</span><span class="o">=</span><span class="n">app_lifespan</span><span class="p">,</span>       <span class="c1"># Optional lifespan manager</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">resource(pattern:</span> <span class="pre">str)</span></code> - Decorator to register a resource handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tool()</span></code> - Decorator to register a tool handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prompt()</span></code> - Decorator to register a prompt handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on_startup()</span></code> - Decorator to register a startup handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on_shutdown()</span></code> - Decorator to register a shutdown handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run(host=&quot;localhost&quot;,</span> <span class="pre">port=8000,</span> <span class="pre">stdio=False)</span></code> - Run the server</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sse_app()</span></code> - Get the SSE ASGI application for mounting</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">websocket_endpoint(websocket:</span> <span class="pre">WebSocket)</span></code> - WebSocket endpoint for Starlette</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notify_resource_changed(uri:</span> <span class="pre">str)</span></code> - Notify clients of a resource change</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notify_tools_changed()</span></code> - Notify clients of tools list changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notify_prompts_changed()</span></code> - Notify clients of prompts list changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_request()</span></code> - Get the current request (in a resource/tool/prompt handler)</p></li>
</ul>
</section>
<section id="context">
<h3>Context<a class="headerlink" href="#context" title="Link to this heading"></a></h3>
<p>The Context object provided to tool and resource handlers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.fastmcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastMCP</span><span class="p">,</span> <span class="n">Context</span>

<span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&quot;MyServer&quot;</span><span class="p">)</span>

<span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">example_tool</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="c1"># Access information and capabilities</span>
    <span class="k">return</span> <span class="s2">&quot;Result&quot;</span>
</pre></div>
</div>
<p>Methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">info(message:</span> <span class="pre">str)</span></code> - Log an informational message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warning(message:</span> <span class="pre">str)</span></code> - Log a warning message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error(message:</span> <span class="pre">str)</span></code> - Log an error message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_resource(uri:</span> <span class="pre">str)</span></code> - Read a resource</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">report_progress(current:</span> <span class="pre">int,</span> <span class="pre">total:</span> <span class="pre">int)</span></code> - Report progress of a long-running task</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">debug(message:</span> <span class="pre">str)</span></code> - Log a debug message</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request_id</span></code> - Get the current request ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">client_id</span></code> - Get the client ID</p></li>
</ul>
</section>
<section id="image">
<h3>Image<a class="headerlink" href="#image" title="Link to this heading"></a></h3>
<p>Utility class for handling image data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.fastmcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastMCP</span><span class="p">,</span> <span class="n">Image</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">PILImage</span>

<span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&quot;MyServer&quot;</span><span class="p">)</span>

<span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_thumbnail</span><span class="p">(</span><span class="n">image_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Image</span><span class="p">:</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">PILImage</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
    <span class="n">img</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Image</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>

<span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_image</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Image</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load an image from disk&quot;&quot;&quot;</span>
    <span class="c1"># FastMCP handles reading and format detection</span>
    <span class="k">return</span> <span class="n">Image</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>Attributes and methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> - Raw image data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">format</span></code> - Image format (e.g., “png”, “jpeg”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mime_type</span></code> - Mime type of the image</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_pil(pil_image)</span></code> - Create an Image from a PIL Image</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code> - Source path for loading images from disk</p></li>
</ul>
</section>
<section id="complex-types-with-pydantic">
<h3>Complex Types with Pydantic<a class="headerlink" href="#complex-types-with-pydantic" title="Link to this heading"></a></h3>
<p>FastMCP supports complex input types using Pydantic models:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Annotated</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.fastmcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastMCP</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ShrimpTank</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Shrimp</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)]</span>

    <span class="n">shrimp</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Shrimp</span><span class="p">]</span>

<span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&quot;Shrimp Manager&quot;</span><span class="p">)</span>

<span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">name_shrimp</span><span class="p">(</span>
    <span class="n">tank</span><span class="p">:</span> <span class="n">ShrimpTank</span><span class="p">,</span>
    <span class="c1"># Field validation in function signatures</span>
    <span class="n">extra_names</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Field</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all shrimp names in the tank&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">shrimp</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">shrimp</span> <span class="ow">in</span> <span class="n">tank</span><span class="o">.</span><span class="n">shrimp</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra_names</span>
</pre></div>
</div>
</section>
<section id="server-with-lifespan">
<h3>Server with Lifespan<a class="headerlink" href="#server-with-lifespan" title="Link to this heading"></a></h3>
<p>Setting up servers with typed lifespan support:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">asynccontextmanager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncIterator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.fastmcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">FastMCP</span><span class="p">,</span> <span class="n">Context</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AppContext</span><span class="p">:</span>
    <span class="n">db</span><span class="p">:</span> <span class="n">Database</span>  <span class="c1"># Your database type</span>

<span class="nd">@asynccontextmanager</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">app_lifespan</span><span class="p">(</span><span class="n">server</span><span class="p">:</span> <span class="n">FastMCP</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">AppContext</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manage application lifecycle with type-safe context&quot;&quot;&quot;</span>
    <span class="c1"># Initialize on startup</span>
    <span class="n">db</span> <span class="o">=</span> <span class="k">await</span> <span class="n">Database</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">AppContext</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Cleanup on shutdown</span>
        <span class="k">await</span> <span class="n">db</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

<span class="c1"># Pass lifespan to server</span>
<span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&quot;My App&quot;</span><span class="p">,</span> <span class="n">lifespan</span><span class="o">=</span><span class="n">app_lifespan</span><span class="p">)</span>

<span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">query_db</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tool that uses initialized resources&quot;&quot;&quot;</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">request_context</span><span class="o">.</span><span class="n">lifespan_context</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="server">
<h3>Server<a class="headerlink" href="#server" title="Link to this heading"></a></h3>
<p>The low-level server API for full control over the MCP server.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">types</span>

<span class="c1"># Create a server</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;MyServer&quot;</span><span class="p">,</span>                 <span class="c1"># Server name</span>
    <span class="n">lifespan</span><span class="o">=</span><span class="n">my_lifespan_function</span><span class="p">,</span>   <span class="c1"># Optional lifespan context manager</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list_resources()</span></code> - Decorator to register a list resources handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_resource()</span></code> - Decorator to register a read resource handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list_tools()</span></code> - Decorator to register a list tools handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">call_tool()</span></code> - Decorator to register a call tool handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list_prompts()</span></code> - Decorator to register a list prompts handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_prompt()</span></code> - Decorator to register a get prompt handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">create_message()</span></code> - Decorator to register a create message handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">register_method(method:</span> <span class="pre">str)</span></code> - Register a custom method handler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_capabilities(...)</span></code> - Get server capabilities</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run(read_stream,</span> <span class="pre">write_stream,</span> <span class="pre">initialization_options)</span></code> - Run the server</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">send_notification(method:</span> <span class="pre">str,</span> <span class="pre">params:</span> <span class="pre">dict)</span></code> - Send a notification to clients</p></li>
</ul>
</section>
</section>
<section id="client-api">
<h2>Client API<a class="headerlink" href="#client-api" title="Link to this heading"></a></h2>
<section id="clientsession">
<h3>ClientSession<a class="headerlink" href="#clientsession" title="Link to this heading"></a></h3>
<p>The main client class for connecting to MCP servers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClientSession</span>

<span class="c1"># Create a session</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">ClientSession</span><span class="p">(</span>
    <span class="n">read_stream</span><span class="p">,</span>            <span class="c1"># Read stream</span>
    <span class="n">write_stream</span><span class="p">,</span>           <span class="c1"># Write stream</span>
    <span class="n">sampling_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Optional message creation callback</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="c1"># Use session...</span>
</pre></div>
</div>
<p>Methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">initialize()</span></code> - Initialize the connection with the server</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list_resources()</span></code> - List available resources</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_resource(uri:</span> <span class="pre">str)</span></code> - Read a resource</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subscribe_resources()</span></code> - Subscribe to resource list changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list_tools()</span></code> - List available tools</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">call_tool(name:</span> <span class="pre">str,</span> <span class="pre">arguments:</span> <span class="pre">dict)</span></code> - Call a tool</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subscribe_tools()</span></code> - Subscribe to tool list changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list_prompts()</span></code> - List available prompts</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_prompt(name:</span> <span class="pre">str,</span> <span class="pre">arguments:</span> <span class="pre">dict)</span></code> - Get a prompt</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subscribe_prompts()</span></code> - Subscribe to prompt list changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">create_message(params:</span> <span class="pre">types.CreateMessageRequestParams)</span></code> - Create a message</p></li>
</ul>
</section>
<section id="connection-functions">
<h3>Connection Functions<a class="headerlink" href="#connection-functions" title="Link to this heading"></a></h3>
<p>Functions for connecting to MCP servers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mcp</span><span class="w"> </span><span class="kn">import</span> <span class="n">StdioServerParameters</span><span class="p">,</span> <span class="n">SocketServerParameters</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mcp.client.stdio</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdio_client</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mcp.client.socket</span><span class="w"> </span><span class="kn">import</span> <span class="n">socket_client</span>

<span class="c1"># Connect to a server over stdio</span>
<span class="n">server_params</span> <span class="o">=</span> <span class="n">StdioServerParameters</span><span class="p">(</span>
    <span class="n">command</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">,</span>         <span class="c1"># Command to run</span>
    <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;server.py&quot;</span><span class="p">],</span>       <span class="c1"># Command arguments</span>
    <span class="n">env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                 <span class="c1"># Optional environment variables</span>
<span class="p">)</span>

<span class="k">async</span> <span class="k">with</span> <span class="n">stdio_client</span><span class="p">(</span><span class="n">server_params</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">read</span><span class="p">,</span> <span class="n">write</span><span class="p">):</span>
    <span class="c1"># Use read and write streams...</span>

<span class="c1"># Connect to a server over WebSocket</span>
<span class="n">server_params</span> <span class="o">=</span> <span class="n">SocketServerParameters</span><span class="p">(</span>
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>         <span class="c1"># Server host</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span>                <span class="c1"># Server port</span>
    <span class="n">ssl</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>                <span class="c1"># SSL/TLS</span>
<span class="p">)</span>

<span class="k">async</span> <span class="k">with</span> <span class="n">socket_client</span><span class="p">(</span><span class="n">server_params</span><span class="p">)</span> <span class="k">as</span> <span class="p">(</span><span class="n">read</span><span class="p">,</span> <span class="n">write</span><span class="p">):</span>
    <span class="c1"># Use read and write streams...</span>
</pre></div>
</div>
</section>
</section>
<section id="type-definitions">
<h2>Type Definitions<a class="headerlink" href="#type-definitions" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mcp.types</span></code> module provides type definitions for MCP primitives:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">mcp.types</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">types</span>

<span class="c1"># Resources</span>
<span class="n">resource</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span>
    <span class="n">uri</span><span class="o">=</span><span class="s2">&quot;example://resource&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;An example resource&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Tools</span>
<span class="n">tool</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">Tool</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;example-tool&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;An example tool&quot;</span><span class="p">,</span>
    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
        <span class="n">types</span><span class="o">.</span><span class="n">ToolArgument</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;An argument&quot;</span><span class="p">,</span>
            <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Prompts</span>
<span class="n">prompt</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">Prompt</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;example-prompt&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;An example prompt&quot;</span><span class="p">,</span>
    <span class="n">arguments</span><span class="o">=</span><span class="p">[</span>
        <span class="n">types</span><span class="o">.</span><span class="n">PromptArgument</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;arg1&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;An argument&quot;</span><span class="p">,</span>
            <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Messages</span>
<span class="n">message</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">PromptMessage</span><span class="p">(</span>
    <span class="n">role</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
    <span class="n">content</span><span class="o">=</span><span class="n">types</span><span class="o">.</span><span class="n">TextContent</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Example message&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="prompt-utilities">
<h2>Prompt Utilities<a class="headerlink" href="#prompt-utilities" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mcp.server.fastmcp.prompts</span></code> module provides utilities for creating prompt messages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.server.fastmcp.prompts</span><span class="w"> </span><span class="kn">import</span> <span class="n">base</span>

<span class="c1"># Create message objects</span>
<span class="n">messages</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">base</span><span class="o">.</span><span class="n">SystemMessage</span><span class="p">(</span><span class="s2">&quot;You are a helpful assistant&quot;</span><span class="p">),</span>
    <span class="n">base</span><span class="o">.</span><span class="n">UserMessage</span><span class="p">(</span><span class="s2">&quot;Hello, how can you help me?&quot;</span><span class="p">),</span>
    <span class="n">base</span><span class="o">.</span><span class="n">AssistantMessage</span><span class="p">(</span><span class="s2">&quot;I can answer questions and help with tasks&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="command-line-interface">
<h2>Command Line Interface<a class="headerlink" href="#command-line-interface" title="Link to this heading"></a></h2>
<p>The MCP CLI provides utilities for working with MCP servers:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the server directly</span>
mcp<span class="w"> </span>run<span class="w"> </span>server.py

<span class="c1"># Test and debug with the MCP Inspector</span>
mcp<span class="w"> </span>dev<span class="w"> </span>server.py

<span class="c1"># Install in Claude Desktop</span>
mcp<span class="w"> </span>install<span class="w"> </span>server.py
</pre></div>
</div>
<section id="development-mode-options">
<h3>Development Mode Options<a class="headerlink" href="#development-mode-options" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add dependencies for testing</span>
mcp<span class="w"> </span>dev<span class="w"> </span>server.py<span class="w"> </span>--with<span class="w"> </span>pandas<span class="w"> </span>--with<span class="w"> </span>numpy

<span class="c1"># Mount local code for live updates</span>
mcp<span class="w"> </span>dev<span class="w"> </span>server.py<span class="w"> </span>--with-editable<span class="w"> </span>.
</pre></div>
</div>
</section>
<section id="installation-options">
<h3>Installation Options<a class="headerlink" href="#installation-options" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Custom server name</span>
mcp<span class="w"> </span>install<span class="w"> </span>server.py<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;My Analytics Server&quot;</span>

<span class="c1"># Environment variables (individual)</span>
mcp<span class="w"> </span>install<span class="w"> </span>server.py<span class="w"> </span>-e<span class="w"> </span><span class="nv">API_KEY</span><span class="o">=</span>abc123<span class="w"> </span>-e<span class="w"> </span><span class="nv">DB_URL</span><span class="o">=</span>postgres://...

<span class="c1"># Environment variables (from file)</span>
mcp<span class="w"> </span>install<span class="w"> </span>server.py<span class="w"> </span>-f<span class="w"> </span>.env

<span class="c1"># Custom server variable</span>
mcp<span class="w"> </span>install<span class="w"> </span>server.py:my_custom_server
</pre></div>
</div>
</section>
</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mcp.exceptions</span></code> module provides exception classes for error handling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">MCPError</span><span class="p">,</span>                    <span class="c1"># Base exception class</span>
    <span class="n">ResourceNotFoundError</span><span class="p">,</span>       <span class="c1"># Resource not found</span>
    <span class="n">ToolNotFoundError</span><span class="p">,</span>           <span class="c1"># Tool not found</span>
    <span class="n">PromptNotFoundError</span><span class="p">,</span>         <span class="c1"># Prompt not found</span>
    <span class="n">InvalidArgumentError</span><span class="p">,</span>        <span class="c1"># Invalid argument</span>
    <span class="n">ServerError</span><span class="p">,</span>                 <span class="c1"># Server error</span>
    <span class="ne">ConnectionError</span><span class="p">,</span>             <span class="c1"># Connection error</span>
    <span class="n">ProtocolError</span><span class="p">,</span>               <span class="c1"># Protocol error</span>
<span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># MCP operation</span>
    <span class="k">pass</span>
<span class="k">except</span> <span class="n">ResourceNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c1"># Handle resource not found</span>
    <span class="k">pass</span>
<span class="k">except</span> <span class="n">MCPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c1"># Handle any MCP error</span>
    <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Link to this heading"></a></h2>
<p>The SDK includes various utility functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mcp.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse_resource_uri</span>

<span class="c1"># Parse a resource URI pattern</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;file://</span><span class="si">{path}</span><span class="s2">&quot;</span>
<span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;file://example.txt&quot;</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">parse_resource_uri</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">uri</span><span class="p">)</span>  <span class="c1"># {&quot;path&quot;: &quot;example.txt&quot;}</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mcp.logging</span><span class="w"> </span><span class="kn">import</span> <span class="n">configure_logging</span>

<span class="c1"># Configure logging</span>
<span class="n">configure_logging</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">)</span>  <span class="c1"># Set logging level</span>
</pre></div>
</div>
<p>For a complete API reference, please refer to the official MCP Python SDK documentation and source code.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples.html" class="btn btn-neutral float-left" title="MCP Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="advanced-topics.html" class="btn btn-neutral float-right" title="Advanced MCP Topics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Model Context Protocol.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>